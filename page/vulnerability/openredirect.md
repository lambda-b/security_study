---
title: オープンリダイレクト
next: false
---

# オープンリダイレクト

## 1. 概要・原因

**オープンリダイレクト**とは、アプリケーションのリダイレクト先URLをユーザー入力に基づいて動的に決定する際、適切な検証が行われないことで、攻撃者が外部の不正なURLへユーザーを誘導できてしまう脆弱性です。

主な原因：

- ユーザーの入力値をリダイレクト先URLとしてそのまま使用
- ホワイトリストやドメインのバリデーションが不足
- `Location` ヘッダに入力値を出力している

## 2. 悪用事例・実際の事件

- フィッシング詐欺で、公式ドメインのURLに見せかけてクリックさせ、外部の悪意あるサイトに転送する
- 銀行や行政のサイトでも報告例があり、クッションページで防止する事例がある

## 3. OWASP ASVS 5.0 における該当要件

| レベル   | 要件番号   | 内容                                             |
|----------|------------|--------------------------------------------------|
| L1〜L3   | V10.6.3     | リダイレクト先の入力が信頼できるものか検証する必要あり       |
| L1〜L3   | V10.6.2     | リダイレクト時に不正な外部URLを許可しない                   |

## 4. 一般的な対策

- リダイレクト先を **固定値** または **ホワイトリスト** から選ぶ
- 外部URLへの遷移は避け、やむを得ない場合は **クッションページ** を挟む
- 入力値に対してスキームやドメインの検証を行う
- 可能であれば絶対URLではなく相対パスを利用する

## 5. フレームワーク別の注意点

### Spring

- `redirect:` や `RedirectView` 使用時に、ユーザー入力を直接使用しない
- パラメータをフィルタし、許可されたURLのみに制限する設計が推奨される

### Struts

- リダイレクトをパラメータで制御する実装では、値のホワイトリスト化が必要
- `response.sendRedirect()` を使用する場合もバリデーションを必須とする

### JSP(Servlet)

- `response.sendRedirect()` の引数にユーザー入力を使わない
- 必要な場合はドメイン検証や正規表現チェックを行う

### React

- フロントでは `window.location` を使うことはあるが、リダイレクト先の検証はサーバ側が責任を持つ
- OAuth などの `redirect_uri` を扱う場合、**サーバ側でホワイトリストチェック**を行うこと